{{- with .Values.kubernetesApi }}
# This ConfigMap is used to overwrite the default kubernetes API environment
# variables to work around the IP SAN limitation of puppet CA.
kind: ConfigMap
apiVersion: v1
metadata:
  name: {{ include "webhook.fullname" $ }}-k8s-api-env
  namespace: {{ $.Release.Namespace | quote }}
  labels:
    app.kubernetes.io/instance: {{ $.Release.Name }}
    {{- include "labels" $ | nindent 4 }}
data:
  KUBERNETES_SERVICE_HOST: "{{ .host }}"
  KUBERNETES_SERVICE_PORT: "{{ .port }}"
{{- end }}