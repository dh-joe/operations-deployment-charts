app:
  image: docker-registry.discovery.wmnet/repos/search-platform/cirrus-streaming-updater/consumer
  job:
    entryClass: org.wikimedia.discovery.cirrus.updater.consumer.ConsumerApplication

  taskManager:
    # NOTE: taskManager.replicas takes precedence over job.parellism.
    # To increase default job parellism, we can increase this
    # and/or flinkConfiguration.taskmanager.numberOfTaskSlots accordingly.
    replicas: 5

  config_files:
    app.config.yaml:
      fetch-retry-queue-capacity: 120
      elasticsearch-bulk-flush-max-size: 26214400 # ~26mb, default (100mb) causes OOM
      elasticsearch-bulk-flush-max-actions: 2560 # max-size / avg action size
      rev-based-fetch-retry-queue-capacity-ratio: 0.333333 # more room for blocking retries

mesh:
  concurrency: 2 # https://phabricator.wikimedia.org/T353460#9437962
  resources:
    requests:
      cpu: 1
    limits:
      cpu: 1
