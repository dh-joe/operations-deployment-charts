helm_scaffold_version: 0.1 # This can be useful when backporting fixes.
docker:
  registry: docker-registry.discovery.wmnet
  pull_policy: IfNotPresent
resources:
  replicas: 1
affinity: {}
tolerations: {}
main_app:
  image: wikimedia/mediawiki-services-kask
  version: 2019-08-14-210839-production
  port: 8081
  # All of this needs to be overriden in production
  certs:
    cassandra:
      ca: |-
        -----BEGIN CERTIFICATE-----
        MIIDWzCCAkOgAwIBAgIJAMDw6wy4LHx5MA0GCSqGSIb3DQEBCwUAMEMxDzANBgNV
        BAMMBnJvb3RDYTEVMBMGA1UECwwMc2VydmljZXMtZGV2MQwwCgYDVQQKDANXTUYx
        CzAJBgNVBAYTAlVTMCAXDTE3MDEwNTIyNTMwMFoYDzIwNjYxMjI0MjI1MzAwWjBD
        MQ8wDQYDVQQDDAZyb290Q2ExFTATBgNVBAsMDHNlcnZpY2VzLWRldjEMMAoGA1UE
        CgwDV01GMQswCQYDVQQGEwJVUzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
        ggEBALH2sG1pHh+kphu2zqDpQ3X7jxlXqLfmMgrcLLXK/hRf1R5EDQ8N5B7kgnH7
        ATDdboaPvHspu1WwE50dlhXK5xXV5U9sTjxd4WWB66v0bKiGn5nifvz9gWGh+0OZ
        nIqxjQHH0YSpjLB/QOcq3GoeIZ5XNynl3BH2q+cWwBFJQYMyf4tMpRm2i2CC+e9/
        3wRIyffAuVv85RjvKhNbRFmNMZARdRqBY/0na/kuE09r6D9PLBRDqzgPaK9vMcr1
        Zu8QE71PE084xDkA/WiCmwZh9WUNotLI+Tvu1AxRlqUA90xPkFthmXoC75AHttts
        S2si6unQFrznaCv1xnYckPvpUycCAwEAAaNQME4wHQYDVR0OBBYEFNmGKdk7wePm
        NqYMJyB8GiBVrXUIMB8GA1UdIwQYMBaAFNmGKdk7wePmNqYMJyB8GiBVrXUIMAwG
        A1UdEwQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAB3nQzHxnqACaoYP/oyeuMrH
        lMGsmTYJgDzP4eAoZj20a3saB7xL9vXvcHwlTJBTeg9ct7aKg67FgCZals2P7+nf
        X1l3vTdwu0dlpkjTzL4nmP1XQ6r6N2mXL498F/y3nQlfUt9efNmy8pfWQFYGN/Ir
        5UPB7o53pkCvqxSf6VK7GE9QB0QetYUBYg78J9xsqhMt0Gr4Qq3vZwUoq2yTA5c5
        IjbQPilZhQ//Focy5fVgFJ++ojhAGadYm30VyP1EkJjvY72mhFaY6fpBptzUL9rz
        NHNq7uXqpFosQptQHiHvN4E9zk1X73Bk7VY4aTE/HtESCT3jxLQDup2p0+v966A=
        -----END CERTIFICATE-----
    kask:
      cert: |-
        -----BEGIN CERTIFICATE-----
        MIIEpjCCAo6gAwIBAgICFBIwDQYJKoZIhvcNAQELBQAwKzEpMCcGA1UEAwwgUHVw
        cGV0IENBOiBwYWxsYWRpdW0uZXFpYWQud21uZXQwHhcNMTkwNTI5MTczODU4WhcN
        MjQwNTI4MTczODU4WjCBhjElMCMGA1UEAwwcc2Vzc2lvbnN0b3JlLmRpc2NvdmVy
        eS53bW5ldDEjMCEGA1UECgwaV2lraW1lZGlhIEZvdW5kYXRpb24sIEluYy4xCzAJ
        BgNVBAYTAlVTMRMwEQYDVQQIDApDYWxpZm9ybmlhMRYwFAYDVQQHDA1TYW4gRnJh
        bmNpc2NvMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEo0mXSs6cuo4petvH4Tf5
        cEta2oFzrAwZi0s70o58512aAGteTtbWByh9M1YSrszhxaHLEvib8A/DtR7Qubrm
        aKOCAUEwggE9MDcGCWCGSAGG+EIBDQQqDChQdXBwZXQgUnVieS9PcGVuU1NMIElu
        dGVybmFsIENlcnRpZmljYXRlMIGBBgNVHREEejB4ghxzZXNzaW9uc3RvcmUuZGlz
        Y292ZXJ5LndtbmV0ghxzZXNzaW9uc3RvcmUuc3ZjLmVxaWFkLndtbmV0ghxzZXNz
        aW9uc3RvcmUuc3ZjLmNvZGZ3LndtbmV0ghxzZXNzaW9uc3RvcmUuZGlzY292ZXJ5
        LndtbmV0MA4GA1UdDwEB/wQEAwIFoDAgBgNVHSUBAf8EFjAUBggrBgEFBQcDAQYI
        KwYBBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNVHQ4EFgQUy3MqWp8zdRDls9e2hX3g
        fSZ3ozMwHwYDVR0jBBgwFoAUWeSGMH4Crw0ApnTtmvYOF65srrowDQYJKoZIhvcN
        AQELBQADggIBALZwcnXPaohiM4W7ABcKRqw5UvwO5X2JSGuPgDgh6VdRs+M2P6lM
        EF/iNVjIyFiZNRaH4/00jHFH1C5LTj1Wf575Pb1o5AeItd+2U1FmVBrOT917NpjQ
        NsjgDfMukhyRahsAvngBZuZRZPFYicIAOMFdzZ5WFzURZd9YszLWSjYcBOpz3UOb
        P0ErM7Lz+QXnruDUjo1yprGWOyffPU7YtEfoFHtkoeKR3RVIhoWSt0AY2zGDWxr1
        SYjYIk0hJDYGOHRN/SX5r+eOolD+O5SqR5lh8H1RAD/SZAPFeCwGqx0OO5rOoEEs
        NmViWG+7E7Q14vtgathNqodE90w92X9/AdgSpBjtRB+v+BOj+xxFbr02Ua56XRi3
        aOczx6vxb2NNeYMhaanncuzBaoBSzJjz02xDXK1RErmoJsyxkGpMhXSf6S+vA66F
        WmTIa3nK9hxi1bddks+eVkx03SYh4pZgXhmEkCu2KzI3KqvmPQPyW41AWneCO2M4
        Vxu0z9xqtlV1I66R/Krz/sbnuyZA+B7QDWVyh9jtrU1JImW7u46GFjoBN5n0LvU9
        1x2qkgDUyinG+zbng4oa5cZ8EKUT+UOe79xuwXHUZFbcLoINudPjbMdg4GdCqbkb
        IBSf6WFpl7UiAs491jFQMvSZkk5Irk2s/iUt3Grv+5B+FkoTa1+6vW8u
        -----END CERTIFICATE-----
#      key: needs to be defined on private/secrets.yaml
  base_uri: sessions/v1
  cassandra:
    authentication:
#     password: # needs to be defined on private/secrets.yaml
      username: restb
    hosts:
      - restbase-dev1004-a.eqiad.wmnet
      - restbase-dev1005-a.eqiad.wmnet
      # Skip this host for now (https://phabricator.wikimedia.org/T224260)
      # - restbase-dev1006-a.eqiad.wmnet
    keyspace: sessions
    table: values
  # WARNING: The value of $wgObjectCacheSessionExpiry in MediaWiki must
  # correspond to the TTL defined here; If you alter default_ttl, update
  # MediaWiki accordingly or problems with session renewal/expiry may occur.
  default_ttl: 3600
  listen_address: 0.0.0.0
  service_name: sessionstore
  log_level: info
  openapi_spec: openapi.yaml
  # See T220401 for how these numbers were calculated
  requests:
    cpu: 150m # T220401
    memory: 100Mi # T220401
  limits:
    cpu: 150m # T220401
    memory: 100Mi # Just some sample, edit these
  liveness_probe:
    tcpSocket:
      port: 8081
  readiness_probe:
    httpGet:
      path: /healthz
      port: 8081
      scheme: HTTPS

service:
  deployment: production
  port: 8081
