resources:
  replicas: 8

monitoring:
  enabled: true

# enable once TLS is ready
mesh:
  enabled: false

strategy:
  maxSurge: 1

discovery:
  listeners:
  - swift-eqiad
  - swift-codfw

main_app:

  version: 2023-01-09-143427-production

  # 3 workers per pod in production
  thumbor_workers: 3

  limits:
    cpu: 2.5
    memory: 2Gi

service:
  deployment: production
  port:
    # We will need to change this to 8800 for use alongside existing
    # thumbor nodes.
    nodePort: 8800

networkpolicy:
  egress:
    enabled: true
    dst_nets:
      # poolcounter1004
      - cidr: 10.64.0.151/32
        ports:
          - protocol: TCP
            port: 7531
      # poolcounter1005
      - cidr: 10.64.32.236/32
        ports:
          - protocol: TCP
            port: 7531
      # poolcounter2003
      - cidr: 10.192.0.132/32
        ports:
          - protocol: TCP
            port: 7531
      # poolcounter2004
      - cidr: 10.192.16.129/32
        ports:
          - protocol: TCP
            port: 7531
      # thumbor1001 - memcached
      - cidr: 10.64.16.56/32
        ports:
          - protocol: TCP
            port: 11211
      # thumbor1002 - memcached
      - cidr: 10.64.16.57/32
        ports:
          - protocol: TCP
            port: 11211
      # thumbor1005 - memcached
      - cidr: 10.64.0.161/32
        ports:
          - protocol: TCP
            port: 11211
      # thumbor1006 - memcached
      - cidr: 10.64.32.149/32
        ports:
          - protocol: TCP
            port: 11211
      # thumbor2003 - memcached
      - cidr: 10.192.16.58/32
        ports:
          - protocol: TCP
            port: 11211
      # thumbor2004 - memcached
      - cidr: 10.192.16.59/32
        ports:
          - protocol: TCP
            port: 11211
      # thumbor2005 - memcached
      - cidr: 10.192.0.97/32
        ports:
          - protocol: TCP
            port: 11211
      # thumbor2006 - memcached
      - cidr: 10.192.48.62/32
        ports:
          - protocol: TCP
            port: 11211
