main_app:
  limits:
    cpu: 3
    memory: 1500Mi

  changeprop:
    event_service_uri: https://eventgate-main.discovery.wmnet:4492/v1/events

    features:
      liftwing_models: true
    liftwing:
      uri: 'https://inference.discovery.wmnet:30443'
      models:
        # See T328576 for more info
        drafttopic:
          concurrency: 5
          match_config_need_quotes: ["wiki_id", "page_change_kind"]
          match_config:
            match:
              wiki_id: 'enwiki'
              page_change_kind: "/^(edit|create)$/"
          namespace: revscoring-drafttopic
          kafka_topic: 'mediawiki.page_change.v1'
          message_wiki_selector: 'wiki_id'
        # See T328899 for more info
        outlink-topic-model:
          concurrency: 5
          match_config_need_quotes: ['wiki_id', 'page_change_kind', 'domain']
          match_config:
            match:
              wiki_id: /^(?!.*(?:commons|meta|species|wikidata)).*wiki$/
              page_change_kind: /^(edit|create|move)$/
              page:
                is_redirect: false
                namespace_id: 0
            match_not:
              meta:
                domain: canary
          namespace: articletopic-outlink
          kafka_topic: 'mediawiki.page_change.v1'

resources:
  replicas: 12
