resources:
  replicas: 2

docker:
  registry: docker-registry.discovery.wmnet
  pull_policy: IfNotPresent

service:
  deployment: production

main_app:
  image: repos/wmde/wikidata-query-gui
  version: 2024-07-26-105140
  port: 8080
  limits:
    cpu: 200m
    memory: 200Mi
  requests:
    cpu: 100m
    memory: 100Mi
  volumeMounts:
    - name: wikidata-custom-config
      mountPath: /srv/app/html/custom-config.json
      subPath: custom-config.json

# additional configmaps which can be mounted in the application container
configMaps:
  wikidata-custom-config:
    custom-config.json: |-
      {
        "api": {
          "sparql": {
            "uri": "/sparql"
            },
          "urlShortener": "wmf"
        },
        "brand": {
          "logo": "logo.svg",
          "favicon": "favicon.ico",
          "title": "Wikidata Query Service",
          "copyrightUrl": "https://www.wikidata.org/wiki/Special:MyLanguage/Wikidata:SPARQL_query_service/Copyright"
        },
        "location": {
          "root": "https://query.wikidata.org/",
          "index": "https://query.wikidata.org/"
        },
        "bannerName": "graph-split"
      }

mesh:
  enabled: true
  public_port: 8081

ingress:
  enabled: true
  gatewayHosts:
    extraFQDNs:
    - query.wikidata.org
    - query-main.wikidata.org
    - query-scholarly.wikidata.org
    - commons-query.wikimedia.org
    # service should not be reachable via the gateway hosts generated by default
    disableDefaultHosts: true
