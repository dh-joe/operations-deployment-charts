# WMF kubernetes cluster specific values.
# These are kept out of the main values.yaml just so that it is easier to use
# with local development.

# TODO:
# app:
#   env:
#     - name: SCHEMA_URIS
#       value: https://schema.discovery.wmnet/repositories/primary/jsonschema/
#     - name: STREAM_CONFIG_URI
#       value: https:/api-ro.discovery.wmnet/

# KUBERNETES_SERVICE_HOST is defaulted by k8s to the ClusterIP
# of the kubernetes apiserver Service.  We need to set it
# to a name that is in the apiserver's TLS cert.
# kubernetes.default.svc.cluster.local should always resolve to
# the right one within the k8s cluster.
kubernetesApi:
  host: kubernetes.default.svc.cluster.local

mesh:
  enabled: false

networkpolicy:
  egress:
    enabled: true
    #TODO:
    # dst_nets:
    #   # Allow schema.svc.{eqiad,codfw}.
    #   # TODO: When we deploy this to production wikikube, we should
    #   # bake the schema repo into the app image just like we do for eventgate-main.
    #   - cidr: 10.2.2.43/32 # schema.svc.eqiad.wmnet
    #     ports:
    #     - protocol: tcp
    #       port: 8190
    #     - protocol: tcp
    #       port: 443
    #   - cidr: 10.2.1.43/32 # schema.svc.codfw.wmnet
    #     ports:
    #     - protocol: tcp
    #       port: 8190
    #     - protocol: tcp
    #       port: 443

# TODO: Setting this currently breaks the helmfile linter jenkins job.  Figure out why.
# kafka:
#   allowed_clusters: [jumbo-eqiad]
