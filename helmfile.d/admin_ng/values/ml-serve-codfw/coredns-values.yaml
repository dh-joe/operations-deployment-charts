# This is before coredns works, we can't rely on internal DNS, so use the external one
kubernetesApi:
  host: ml-ctrl.svc.codfw.wmnet
  port: 6443

replicaCount: 4

service:
  clusterIP: 10.194.0.3

# Measure to deal with https://phabricator.wikimedia.org/T318814
# By default Kubernetes DNS records have 5s TTL, and in a Service Mesh
# like Istio this means causing a lot of DNS queries from Envoy to refresh
# every TTL seconds all the Clusters with STRICT_DNS settings.
coredns:
  rewrite_actions:
    continue:
    - 'ttl exact knative-local-gateway.istio-system.svc.cluster.local. 30'
    - 'ttl regex (.*).discovery.wmnet 30'
    - 'ttl regex (.*)-(predictor|transformer)-default-(.*) 30'
